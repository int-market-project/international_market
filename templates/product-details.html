<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{page_title}}</title>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/menu.css">
    <link rel="stylesheet" href="/css/footer.css">
    <link rel="stylesheet" href="/css/home.css">
    <link rel="stylesheet" href="/css/product-details.css">
</head>

<body>
    <header>
        <div id="pc-header-container">
            <div class="pc-first-ribbon-header">
                <div class="pc-first-ribbon-left-container">
                    <div><a href="/about-us/" class="gray-text text lato-text">About Us</a></div>
                    <div>
                        <p class="gray-text text lato-text">|</p>
                    </div>
                    <div><a href="{{ '/my-account/' if current_customer else '/login' }}"
                            class="gray-text text lato-text">My Account</a></div>
                    <div>
                        <p class="gray-text text lato-text">|</p>
                    </div>
                    <div><a href="{{ '/wishlist/' if current_customer else '/login' }}"
                            class="gray-text text lato-text">Wishlist</a></div>
                    <div>
                        <p class="gray-text text lato-text">|</p>
                    </div>
                    <div><a href="/help-center/" class="gray-text text lato-text">Help center</a></div>
                </div>
                <div class="pc-first-ribbon-middle-container">
                    <a href="/#hot-deals" class="pc-banner-link ocean-green-text text lato-text">
                        <span class="pc-banner-text">
                            Flash Deals Are Live — Steal the Best Offers Now!
                        </span>
                    </a>
                </div>
                <script>
                    document.addEventListener('DOMContentLoaded', function () {
                        const messages = [
                            "Flash Deals Are Live — Steal the Best Offers Now!",
                            "Mega Discounts Today — Shop Before Stocks Run Out!",
                            "Fresh Deals Every Day — Shop & Save More",
                            "Super Value Deals — Save More Every Day",
                            "Exclusive Offers Live Now — Don’t Miss Out"
                        ];

                        const textEls = document.querySelectorAll('.pc-banner-text');
                        if (!textEls.length) return;

                        let idx = 0;

                        function showMessage(i) {
                            textEls.forEach(el => {
                                el.textContent = messages[i];
                                el.classList.add('is-visible');
                            });
                        }

                        function hideMessage() {
                            textEls.forEach(el => {
                                el.classList.remove('is-visible');
                            });
                        }

                        // first line
                        showMessage(idx);

                        setInterval(function () {
                            hideMessage();
                            setTimeout(function () {
                                idx = (idx + 1) % messages.length;
                                showMessage(idx);
                            }, 400); // match CSS transition
                        }, 2000); // each line stays ~2 seconds
                    });
                </script>
                <div class="pc-first-ribbon-right-container">
                    <p class="gray-text text lato-text">
                        Need help? Call Us:
                        <a href="tel:{{app_settings.number_to_give}}"
                            class="ocean-green-text">{{app_settings.number_to_show}}</a>
                    </p>
                </div>
            </div>
            <div class="pc-second-ribbon-header">
                <div class="pc-second-ribbon-logo-container">
                    <a href="/"><img src="https://ik.imagekit.io/intmarket/logo.png?updatedAt=1763862184023" alt=""></a>
                </div>
                <div class="pc-second-ribbon-search-bar-container" data-global-search="1">
                    <div class="pc-search-bar">
                        <input id="globalKeywordPc" class="gray-text text lato-text" type="text"
                            placeholder="Search for products...">
                        <a id="globalSearchBtnPc" href="/search-results/" class="gray-text text lato-text">Search</a>
                    </div>
                </div>
                <div class="pc-second-ribbon-buttons-container">
                    <a href="{{ '/wishlist/' if current_customer else '/login' }}"
                        class="pc-second-ribbon-button-container">
                        <div class="pc-second-ribbon-button-container-div">
                            <div class="pc-second-ribbon-button-image-container">
                                <div class="pc-second-ribbon-button-image">
                                    <img src="https://ik.imagekit.io/intmarket/wishlist.png?updatedAt=1763862183984"
                                        alt="">
                                </div>
                                <div class="pc-second-ribbon-button-number">
                                    <p id="wishlist-qty-pc" class="ocean-green-text text quicksand-text">{{ wishlist_qty
                                        }}</p>
                                </div>
                            </div>
                            <div class="pc-second-ribbon-button-name-container">
                                <p class="gray-text text lato-text">Wishlist</p>
                            </div>
                        </div>
                    </a>
                    <a href="{{ '/cart/' if current_customer else '/login' }}"
                        class="pc-second-ribbon-button-container">
                        <div class="pc-second-ribbon-button-container-div">
                            <div class="pc-second-ribbon-button-image-container">
                                <div class="pc-second-ribbon-button-image">
                                    <img src="https://ik.imagekit.io/intmarket/cart.png?updatedAt=1763862183972" alt="">
                                </div>
                                <div class="pc-second-ribbon-button-number">
                                    <p id="cart-qty-pc" class="ocean-green-text text quicksand-text">{{ cart_qty }}</p>
                                </div>
                            </div>
                            <div class="pc-second-ribbon-button-name-container">
                                <p class="gray-text text lato-text">Cart</p>
                            </div>
                        </div>
                    </a>
                    <a href="{{ '/my-account/' if current_customer else '/login' }}"
                        class="pc-second-ribbon-button-container">
                        <div class="pc-second-ribbon-button-container-div">
                            <div class="pc-second-ribbon-button-image-container">
                                <div class="pc-second-ribbon-button-image">
                                    <img src="https://ik.imagekit.io/intmarket/user.png?updatedAt=1763862183956" alt="">
                                </div>
                            </div>
                            <div class="pc-second-ribbon-button-name-container">
                                <p class="gray-text text lato-text">Account</p>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="pc-third-ribbon-header">
                <div class="pc-third-ribbon-buttons-container">
                    <div class="pc-menu-categories-wrapper">
                        <button class="pc-menu-categories-button">
                            <div class="categories-button-image-container">
                                <img src="https://ik.imagekit.io/intmarket/apps.png?updatedAt=1763862183985" alt="">
                            </div>
                            <p class="white-text text quicksand-text">Browse All Categories</p>
                            <div class="categories-button-arrow-container">
                                <span class="categories-button-arrow">&#9662;</span> <!-- down arrow -->
                            </div>
                        </button>
                        <div class="pc-menu-categories-dropdown">
                            {% for category in parent_categories %}
                            <div class="pc-menu-category-button-container">
                                <a href="/subcategories/?category_name={{ category.slug }}"
                                    class="pc-menu-category-button">
                                    {% if category.image_url %}
                                    <div class="category-button-image-container">
                                        <img src="{{ category.image_url }}" alt="{{ category.name }}">
                                    </div>
                                    {% endif %}
                                    <p class="rhino-text text quicksand-text">
                                        {{ category.name }}
                                    </p>
                                    <div class="category-button-quantity-container">
                                        <p class="white-text text quicksand-text">
                                            {{ category.subcategory_count }}
                                        </p>
                                    </div>
                                </a>
                            </div>
                            {% endfor %}
                        </div>
                        <script>
                            document.addEventListener('DOMContentLoaded', function () {
                                const wrapper = document.querySelector('.pc-menu-categories-wrapper');
                                if (!wrapper) return;

                                const button = wrapper.querySelector('.pc-menu-categories-button');

                                // Toggle open/close on button click
                                button.addEventListener('click', function (e) {
                                    e.stopPropagation(); // don't let the click bubble to document
                                    wrapper.classList.toggle('is-open');
                                });

                                // Close when clicking anywhere else
                                document.addEventListener('click', function (e) {
                                    if (!wrapper.contains(e.target)) {
                                        wrapper.classList.remove('is-open');
                                    }
                                });
                            });
                        </script>
                    </div>
                    <div class="pc-menu-hot-deals-button">
                        <a href="/#hot-deals" class="pc-second-ribbon-button-container">
                            <div class="pc-second-ribbon-button-container-div">
                                <div class="pc-second-ribbon-button-image-container">
                                    <div class="pc-second-ribbon-button-image">
                                        <img src="https://ik.imagekit.io/intmarket/flame.png?updatedAt=1763862183933"
                                            alt="">
                                    </div>
                                </div>
                                <div class="pc-second-ribbon-button-name-container">
                                    <p class="rhino-text text quicksand-text">Hot Deals</p>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="pc-third-ribbon-menu-container">
                    <div class="pc-third-ribbon-menu-item">
                        <a href="/" class="pc-third-ribbon-menu-link rhino-text text quicksand-text">Home</a>
                    </div>
                    <div class="pc-third-ribbon-menu-item">
                        <a href="/about-us/" class="pc-third-ribbon-menu-link rhino-text text quicksand-text">About
                            Us</a>
                    </div>
                    <div class="pc-third-ribbon-menu-item pc-has-mega">
                        <button type="button"
                            class="pc-mega-trigger pc-third-ribbon-mega-menu-link rhino-text text quicksand-text">
                            Shop
                            <span class="pc-mega-arrow">&#9662;</span>
                        </button>
                        <div class="pc-mega-dropdown">
                            <div class="pc-dropdown-content-container">
                                <h1 class="ocean-green-text quicksand-text sub-title">Shop by Categories</h1>

                                {% for cat in mega_parent_categories %}
                                <a href="/subcategories/?category_name={{ cat.slug }}"
                                    class="pc-third-ribbon-menu-link gray-text lato-text text">
                                    {{ cat.name }}
                                </a>
                                {% endfor %}
                            </div>
                            <div class="pc-dropdown-content-container">
                                <h1 class="ocean-green-text quicksand-text sub-title">Featured Categories</h1>

                                {% for sub in mega_featured_subcategories %}
                                <a href="/search-results/?category={{ sub.parent_slug }}&subcategory={{ sub.slug }}&min_price=0&max_price=1000&hot_deal=true&popular=true&sort=default"
                                    class="pc-third-ribbon-menu-link gray-text lato-text text">
                                    {{ sub.name }}
                                </a>
                                {% endfor %}

                                <a href="/#featured-categories"
                                    class="pc-third-ribbon-menu-link gray-text lato-text text">
                                    View All Featured Categories
                                </a>
                            </div>
                            <div class="pc-dropdown-content-container">
                                <h1 class="ocean-green-text quicksand-text sub-title">Store Tools</h1>
                                <a href="{{ '/wishlist/' if current_customer else '/login' }}"
                                    class="pc-third-ribbon-menu-link gray-text lato-text text">Wishlist</a>
                                <a href="{{ '/cart/' if current_customer else '/login' }}"
                                    class="pc-third-ribbon-menu-link gray-text lato-text text">Cart</a>
                                <a href="/#popular-products"
                                    class="pc-third-ribbon-menu-link gray-text lato-text text">Popular
                                    Products</a>
                                <a href="/#hot-deals" class="pc-third-ribbon-menu-link gray-text lato-text text">Hot
                                    Deals</a>
                                <a href="/#new-arrivals" class="pc-third-ribbon-menu-link gray-text lato-text text">New
                                    Arrivals</a>
                                <a href="/cart#recently-viewed"
                                    class="pc-third-ribbon-menu-link gray-text lato-text text">Recently
                                    Viewed</a>
                            </div>
                            <div class="pc-dropdown-last-container">
                                <h1 class="ocean-green-text quicksand-text text">Fresh Arrivals</h1>
                                <h1 class="rhino-text sub-title quicksand-text">Today’s Freshly Stocked Produce</h1>
                                <div class="pc-dropdown-last-container-image-container">
                                    <div class="pc-dropdown-last-container-image-container-button">
                                        <a href="/#hot-deals" class="white-text text quicksand-text">Shop Fresh</a>
                                    </div>
                                    <div class="pc-dropdown-last-container-image-container-image">
                                        <img src="https://ik.imagekit.io/intmarket/top-half-view-circle-shape-hot-peppers-cherry-tomatoes-basket-vegetables-circle-amber-background_140725-131600-removebg-preview.png"
                                            alt="">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="pc-third-ribbon-menu-item">
                        <a href="/privacy-policy/"
                            class="pc-third-ribbon-menu-link rhino-text text quicksand-text">Privacy Policy</a>
                    </div>
                    <div class="pc-third-ribbon-menu-item">
                        <a href="/refund-and-return-policy/"
                            class="pc-third-ribbon-menu-link rhino-text text quicksand-text">Refund and Return
                            Policy</a>
                    </div>
                    <div class="pc-third-ribbon-menu-item">
                        <a href="/contact-us/" class="pc-third-ribbon-menu-link rhino-text text quicksand-text">Contact
                            Us</a>
                    </div>
                    <div class="pc-third-ribbon-menu-item">
                        <a href="/suggest-product/"
                            class="pc-third-ribbon-menu-link rhino-text text quicksand-text">Suggest a Product</a>
                    </div>
                    <script>
                        document.addEventListener('DOMContentLoaded', function () {
                            const megaItems = document.querySelectorAll('.pc-has-mega');

                            megaItems.forEach(item => {
                                let hideTimeout;
                                const trigger = item.querySelector('.pc-mega-trigger');
                                const dropdown = item.querySelector('.pc-mega-dropdown');

                                function openMega() {
                                    megaItems.forEach(i => { if (i !== item) i.classList.remove('is-open'); });
                                    clearTimeout(hideTimeout);
                                    item.classList.add('is-open');
                                }

                                function closeMega() {
                                    hideTimeout = setTimeout(() => {
                                        item.classList.remove('is-open');
                                    }, 500); // 0.5s grace to move cursor
                                }

                                // Hover logic
                                trigger.addEventListener('mouseenter', openMega);
                                trigger.addEventListener('mouseleave', closeMega);

                                dropdown.addEventListener('mouseenter', () => {
                                    clearTimeout(hideTimeout);
                                    openMega();
                                });

                                dropdown.addEventListener('mouseleave', closeMega);
                            });
                        });
                    </script>
                </div>
            </div>
        </div>
        <div id="mobile-header-container">
            <div class="m-first-ribbon">
                <a href="/#hot-deals" class="pc-banner-link ocean-green-text text lato-text">
                    <span class="pc-banner-text">
                        Flash Deals Are Live — Steal the Best Offers Now!
                    </span>
                </a>
            </div>
            <div class="m-second-ribbon">
                <div class="m-logo">
                    <a href="/"><img src="https://ik.imagekit.io/intmarket/logo.png?updatedAt=1763862184023"
                            alt="International Market Logo"></a>
                </div>
                <div class="m-header-right">
                    <a href="{{ '/wishlist/' if current_customer else '/login' }}" class="m-icon-link">
                        <div class="pc-second-ribbon-button-image-container">
                            <div class="pc-second-ribbon-button-image">
                                <img src="https://ik.imagekit.io/intmarket/wishlist.png?updatedAt=1763862183984"
                                    alt="Wishlist">
                            </div>
                            <div class="pc-second-ribbon-button-number">
                                <p id="wishlist-qty-mobile" class="ocean-green-text text quicksand-text">{{ wishlist_qty
                                    }}</p>
                            </div>
                        </div>
                    </a>
                    <a href="{{ '/cart/' if current_customer else '/login' }}" class="m-icon-link">
                        <div class="pc-second-ribbon-button-image-container">
                            <div class="pc-second-ribbon-button-image">
                                <img src="https://ik.imagekit.io/intmarket/cart.png?updatedAt=1763862183972" alt="Cart">
                            </div>
                            <div class="pc-second-ribbon-button-number">
                                <p id="cart-qty-mobile" class="ocean-green-text text quicksand-text">{{ cart_qty }}</p>
                            </div>
                        </div>
                    </a>
                    <a href="{{ '/my-account/' if current_customer else '/login' }}" class="m-icon-link">
                        <div class="pc-second-ribbon-button-image-container">
                            <div class="pc-second-ribbon-button-image">
                                <img src="https://ik.imagekit.io/intmarket/user.png?updatedAt=1763862183956"
                                    alt="Account">
                            </div>
                        </div>
                    </a>
                    <button type="button" class="m-menu-toggle" aria-label="Open menu">
                        <span class="m-bar"></span>
                        <span class="m-bar"></span>
                        <span class="m-bar"></span>
                    </button>
                </div>
            </div>
            <div class="m-third-ribbon">
                <div class="m-search-wrapper" data-global-search="1">
                    <div class="pc-search-bar">
                        <input id="globalKeywordMobile" class="gray-text text lato-text" type="text"
                            placeholder="Search for products...">
                        <a id="globalSearchBtnMobile" href="/search-results/"
                            class="gray-text text lato-text">Search</a>
                    </div>
                </div>
            </div>
            <div id="m-menu-overlay" class="m-menu-overlay">
                <div class="m-menu-panel">
                    <button type="button" class="m-menu-close" aria-label="Close menu">&times;</button>
                    <div class="m-menu-content">
                        <div class="m-menu-control-container">
                            <button class="gray-text text lato-text m-tab-btn-x92 m-tab-active"
                                data-x92-target="panel-menu-x92">Menu</button>
                            <button class="gray-text text lato-text m-tab-btn-x92"
                                data-x92-target="panel-category-x92">Category</button>
                        </div>
                        <div class="m-tab-panels-x92">
                            <div id="panel-menu-x92" class="m-tab-panel-x92 m-panel-active">
                                <div class="m-third-ribbon-menu-item">
                                    <a href="/" class="m-third-ribbon-menu-link rhino-text text quicksand-text">Home</a>
                                </div>
                                <div class="m-third-ribbon-menu-item">
                                    <a href="/about-us/"
                                        class="m-third-ribbon-menu-link rhino-text text quicksand-text">About
                                        Us</a>
                                </div>
                                <div class="m-third-ribbon-menu-item m-has-dropdown">
                                    <button type="button" class="m-dropdown-toggle rhino-text text quicksand-text">
                                        <span>Shop</span>
                                        <span class="m-dropdown-arrow">&#9662;</span>
                                    </button>
                                    <div class="m-dropdown-panel">
                                        <div class="m-dropdown-content-container">
                                            <h1 class="ocean-green-text quicksand-text sub-title">Shop by Categories
                                            </h1>

                                            {% for cat in mega_parent_categories %}
                                            <a href="/subcategories/?category_name={{ cat.slug }}"
                                                class="pc-third-ribbon-menu-link gray-text lato-text text">
                                                {{ cat.name }}
                                            </a>
                                            {% endfor %}
                                        </div>
                                        <div class="m-dropdown-content-container">
                                            <h1 class="ocean-green-text quicksand-text sub-title">
                                                Featured Categories
                                            </h1>

                                            {% for sub in mega_featured_subcategories %}
                                            <a href="/search-results/?category={{ sub.parent_slug }}&subcategory={{ sub.slug }}&min_price=0&max_price=1000&hot_deal=true&popular=true&sort=default"
                                                class="pc-third-ribbon-menu-link gray-text lato-text text">
                                                {{ sub.name }}
                                            </a>
                                            {% endfor %}

                                            <a href="/#featured-categories"
                                                class="pc-third-ribbon-menu-link gray-text lato-text text">
                                                View All Featured Categories
                                            </a>
                                        </div>
                                        <div class="m-dropdown-content-container">
                                            <h1 class="ocean-green-text quicksand-text sub-title">Store Tools</h1>
                                            <a href="{{ '/wishlist/' if current_customer else '/login' }}"
                                                class="pc-third-ribbon-menu-link gray-text lato-text text">Wishlist</a>
                                            <a href="{{ '/cart/' if current_customer else '/login' }}"
                                                class="pc-third-ribbon-menu-link gray-text lato-text text">Cart</a>
                                            <a href="/#popular-products"
                                                class="pc-third-ribbon-menu-link gray-text lato-text text">Popular
                                                Products</a>
                                            <a href="/#hot-deals"
                                                class="pc-third-ribbon-menu-link gray-text lato-text text">Hot
                                                Deals</a>
                                            <a href="/#new-arrivals"
                                                class="pc-third-ribbon-menu-link gray-text lato-text text">New
                                                Arrivals</a>
                                            <a href="/cart#recently-viewed"
                                                class="pc-third-ribbon-menu-link gray-text lato-text text">Recently
                                                Viewed</a>
                                        </div>
                                        <div class="m-dropdown-last-container">
                                            <h1 class="ocean-green-text quicksand-text text">Fresh Arrivals</h1>
                                            <h1 class="rhino-text sub-title quicksand-text">Today’s Freshly Stocked
                                                Produce</h1>
                                            <div class="m-dropdown-last-container-image-container">
                                                <div class="m-dropdown-last-container-image-container-button">
                                                    <a href="/#hot-deals" class="white-text text quicksand-text">Shop
                                                        Fresh</a>
                                                </div>
                                                <div class="m-dropdown-last-container-image-container-image">
                                                    <img src="https://ik.imagekit.io/intmarket/top-half-view-circle-shape-hot-peppers-cherry-tomatoes-basket-vegetables-circle-amber-background_140725-131600-removebg-preview.png"
                                                        alt="">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', function () {
                                            const shopItem = document.querySelector(
                                                '#panel-menu-x92 .m-third-ribbon-menu-item.m-has-dropdown'
                                            );
                                            if (!shopItem) return;

                                            const toggle = shopItem.querySelector('.m-dropdown-toggle');

                                            toggle.addEventListener('click', function (e) {
                                                e.stopPropagation();
                                                shopItem.classList.toggle('is-open');
                                            });
                                        });
                                    </script>
                                </div>
                                <div class="m-third-ribbon-menu-item">
                                    <a href="{{ '/my-account/' if current_customer else '/login' }}"
                                        class="m-third-ribbon-menu-link rhino-text text quicksand-text">My Account</a>
                                </div>
                                <div class="m-third-ribbon-menu-item">
                                    <a href="{{ '/wishlist/' if current_customer else '/login' }}"
                                        class="m-third-ribbon-menu-link rhino-text text quicksand-text">Wishlist</a>
                                </div>
                                <div class="m-third-ribbon-menu-item">
                                    <a href="/privacy-policy/"
                                        class="m-third-ribbon-menu-link rhino-text text quicksand-text">Privacy
                                        Policy</a>
                                </div>
                                <div class="m-third-ribbon-menu-item">
                                    <a href="/refund-and-return-policy/"
                                        class="m-third-ribbon-menu-link rhino-text text quicksand-text">Refund and
                                        Return
                                        Policy</a>
                                </div>
                                <div class="m-third-ribbon-menu-item">
                                    <a href="/contact-us/"
                                        class="m-third-ribbon-menu-link rhino-text text quicksand-text">Contact
                                        Us</a>
                                </div>
                                <div class="m-third-ribbon-menu-item">
                                    <a href="/suggest-product/"
                                        class="m-third-ribbon-menu-link rhino-text text quicksand-text">Suggest a
                                        Product</a>
                                </div>
                                <div class="m-third-ribbon-menu-item">
                                    <a href="/help-center/"
                                        class="m-third-ribbon-menu-link rhino-text text quicksand-text">Help Center</a>
                                </div>
                            </div>
                            <div id="panel-category-x92" class="m-tab-panel-x92">
                                <div class="extra-space-above-container"></div>
                                {% for category in parent_categories %}
                                <div class="m-menu-category-button-container">
                                    <a href="/subcategories/?category_name={{ category.slug }}"
                                        class="m-menu-category-button">
                                        {% if category.image_url %}
                                        <div class="category-button-image-container">
                                            <img src="{{ category.image_url }}" alt="{{ category.name }}">
                                        </div>
                                        {% endif %}
                                        <p class="rhino-text text quicksand-text">
                                            {{ category.name }}
                                        </p>
                                        <div class="category-button-quantity-container">
                                            <p class="white-text text quicksand-text">
                                                {{ category.subcategory_count }}
                                            </p>
                                        </div>
                                    </a>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="m-after-menu-content-menu">
                            <div class="m-menu-hot-deals-button">
                                <a href="/#hot-deals" class="m-second-ribbon-button-container">
                                    <div class="pc-second-ribbon-button-container-div">
                                        <div class="pc-second-ribbon-button-image-container">
                                            <div class="pc-second-ribbon-button-image">
                                                <img src="https://ik.imagekit.io/intmarket/flame.png?updatedAt=1763862183933"
                                                    alt="">
                                            </div>
                                        </div>
                                        <div class="pc-second-ribbon-button-name-container">
                                            <p class="rhino-text text quicksand-text">Hot Deals</p>
                                        </div>
                                    </div>
                                </a>
                            </div>
                            <div class="m-menu-need-help-content-container">
                                <p class="gray-text text lato-text">
                                    Need help? Call Us:
                                    <a href="tel:{{app_settings.number_to_give}}"
                                        class="ocean-green-text">{{app_settings.number_to_show}}</a>
                                </p>
                            </div>
                        </div>
                    </div>
                    <script>
                        document.addEventListener("DOMContentLoaded", () => {
                            const btns = document.querySelectorAll(".m-tab-btn-x92");
                            const panels = document.querySelectorAll(".m-tab-panel-x92");

                            btns.forEach(btn => {
                                btn.addEventListener("click", () => {
                                    const target = btn.dataset.x92Target;

                                    // Remove active from buttons
                                    btns.forEach(b => b.classList.remove("m-tab-active"));

                                    // Add active to clicked button
                                    btn.classList.add("m-tab-active");

                                    // Hide all panels
                                    panels.forEach(p => p.classList.remove("m-panel-active"));

                                    // Show the clicked panel
                                    document.getElementById(target).classList.add("m-panel-active");
                                });
                            });
                        });
                    </script>
                </div>
            </div>
            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    const toggleBtn = document.querySelector('.m-menu-toggle');
                    const overlay = document.getElementById('m-menu-overlay');
                    const closeBtn = overlay ? overlay.querySelector('.m-menu-close') : null;
                    const panel = overlay ? overlay.querySelector('.m-menu-panel') : null;

                    if (!toggleBtn || !overlay || !closeBtn || !panel) return;

                    function openMenu() {
                        overlay.classList.add('is-open');
                        document.body.classList.add('mobile-menu-open');
                    }

                    function closeMenu() {
                        overlay.classList.remove('is-open');
                        document.body.classList.remove('mobile-menu-open');
                    }

                    toggleBtn.addEventListener('click', function (e) {
                        e.stopPropagation();
                        openMenu();
                    });

                    closeBtn.addEventListener('click', function (e) {
                        e.stopPropagation();
                        closeMenu();
                    });

                    /* click outside panel closes menu */
                    overlay.addEventListener('click', function (e) {
                        if (!panel.contains(e.target)) {
                            closeMenu();
                        }
                    });
                });
            </script>
        </div>
        <script>
            (function () {
                // If we're on /search-results/, do nothing.
                // (You said search page won't include this container anyway, but this is extra safe.)
                if (window.location.pathname === "/search-results/") return;

                const pcInput = document.getElementById("globalKeywordPc");
                const mInput = document.getElementById("globalKeywordMobile");
                const pcBtn = document.getElementById("globalSearchBtnPc");
                const mBtn = document.getElementById("globalSearchBtnMobile");

                function isVisible(el) {
                    return !!(el && el.offsetParent !== null);
                }

                function getKeyword() {
                    // Prefer visible input
                    if (isVisible(pcInput)) return (pcInput.value || "").trim();
                    if (isVisible(mInput)) return (mInput.value || "").trim();

                    // Fallback
                    const pcVal = pcInput ? (pcInput.value || "").trim() : "";
                    const mVal = mInput ? (mInput.value || "").trim() : "";
                    return pcVal || mVal;
                }

                function setKeyword(val) {
                    if (pcInput) pcInput.value = val;
                    if (mInput) mInput.value = val;
                }

                // Keep PC + Mobile keyword synced
                if (pcInput) pcInput.addEventListener("input", () => setKeyword(pcInput.value));
                if (mInput) mInput.addEventListener("input", () => setKeyword(mInput.value));

                function buildDefaultSearchParams(keyword) {
                    const p = new URLSearchParams();

                    // ✅ IMPORTANT: do NOT search if keyword is empty
                    // (Prevents showing all products)
                    if (keyword) {
                        p.set("keyword", keyword);
                    } else {
                        return null;
                    }

                    // defaults
                    p.set("category", "all");
                    p.set("subcategory", "all");
                    p.set("min_price", "0");
                    p.set("max_price", "1000");
                    p.set("hot_deal", "true");
                    p.set("popular", "true");
                    p.set("sort", "default");

                    return p;
                }

                function goToSearchResultsWithDefaults(e) {
                    if (e) e.preventDefault();

                    const kw = getKeyword();
                    const params = buildDefaultSearchParams(kw);

                    // If keyword empty, just focus the visible input and stop.
                    if (!params) {
                        if (isVisible(pcInput)) pcInput.focus();
                        else if (isVisible(mInput)) mInput.focus();
                        return;
                    }

                    window.location.href = "/search-results/?" + params.toString();
                }

                // Button clicks
                if (pcBtn) pcBtn.addEventListener("click", goToSearchResultsWithDefaults);
                if (mBtn) mBtn.addEventListener("click", goToSearchResultsWithDefaults);

                // Enter key triggers search
                [pcInput, mInput].forEach(inp => {
                    if (!inp) return;
                    inp.addEventListener("keydown", (e) => {
                        if (e.key === "Enter") {
                            e.preventDefault();
                            goToSearchResultsWithDefaults(e);
                        }
                    });
                });
            })();
        </script>
    </header>
    <section id="product-details">
        <div class="product-details-info-container">
            <div class="product-details-images-container">
                <div class="pd-main-image-wrap">
                    <img id="pdMainImage" class="pd-main-image" src="{{ product.cover_image }}"
                        alt="{{ product.name }}">
                </div>

                <div class="pd-thumbs">
                    {% for img in product.image_urls %}
                    <button type="button" class="pd-thumb {% if loop.first %}is-active{% endif %}" data-src="{{ img }}"
                        aria-label="View image {{ loop.index }}">
                        <img src="{{ img }}" alt="{{ product.name }} thumbnail {{ loop.index }}">
                    </button>
                    {% endfor %}
                </div>
            </div>
            <script>
                document.addEventListener("DOMContentLoaded", () => {
                    const mainImg = document.getElementById("pdMainImage");
                    const thumbs = document.querySelectorAll(".pd-thumb");

                    if (!mainImg || !thumbs.length) return;

                    function setActive(btn) {
                        thumbs.forEach(t => t.classList.remove("is-active"));
                        btn.classList.add("is-active");
                    }

                    thumbs.forEach(btn => {
                        btn.addEventListener("click", () => {
                            const src = btn.dataset.src;
                            if (!src) return;

                            // swap main image
                            mainImg.src = src;

                            // active border highlight
                            setActive(btn);
                        });
                    });
                });
            </script>
            <div class="product-details-content-container">
                <h1 class="quicksand-text rhino-text title" style="margin-bottom: 20px;">{{product.name}}</h1>
                {% set has_tags = product.is_featured or product.is_hot_deal or product.is_new %}
                {% if has_tags %}
                <div class="product-details-features-container">
                    {% if product.is_featured %}
                    <span class="pd-tag pd-tag-popular rhino-text lato-text text">Popular</span>
                    {% endif %}

                    {% if product.is_hot_deal %}
                    <span class="pd-tag pd-tag-hot rhino-text lato-text text">Hot Deal</span>
                    {% endif %}

                    {% if product.is_new %}
                    <span class="pd-tag pd-tag-new rhino-text lato-text text">New</span>
                    {% endif %}
                </div>
                {% endif %}
                <div class="product-details-rating-container">
                    <div class="product-rating-container" data-rating="{{ product.rating }}"
                        aria-label="Rating {{ product.rating }} out of 5">
                    </div>

                    <p class="lato-text text gray-text pd-rating-text">
                        {{ product.rating }} / 5
                        {% if product.ratings_list %}
                        ({{ product.ratings_list | length }} reviews)
                        {% else %}
                        (0 reviews)
                        {% endif %}
                    </p>
                </div>
                <script>
                    document.addEventListener("DOMContentLoaded", () => {

                        // Star SVG path (nice rounded star)
                        const STAR_SVG = `
<svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
  <path d="M12 2.3l2.85 6.56 7.15.62-5.42 4.7 1.62 7.02L12 17.9 5.8 21.2l1.62-7.02L2 9.48l7.15-.62L12 2.3z"></path>
</svg>
`;

                        function clamp(num, min, max) {
                            return Math.min(max, Math.max(min, num));
                        }

                        function buildStar(type) {
                            if (type === "full") {
                                return `<span class="star full">${STAR_SVG}</span>`;
                            }
                            if (type === "empty") {
                                return `<span class="star empty">${STAR_SVG}</span>`;
                            }
                            // half
                            return `
  <span class="star half">
    <span class="base">${STAR_SVG}</span>
    <span class="fill">${STAR_SVG}</span>
  </span>
`;
                        }

                        function renderRating(container, ratingRaw) {
                            let rating = parseFloat(ratingRaw);
                            if (Number.isNaN(rating)) rating = 0;

                            rating = clamp(rating, 0, 5);

                            // Round to nearest 0.5 (optional but makes display consistent)
                            rating = Math.round(rating * 2) / 2;

                            const fullCount = Math.floor(rating);
                            const hasHalf = (rating - fullCount) === 0.5;
                            const emptyCount = 5 - fullCount - (hasHalf ? 1 : 0);

                            let html = "";

                            for (let i = 0; i < fullCount; i++) html += buildStar("full");
                            if (hasHalf) html += buildStar("half");
                            for (let i = 0; i < emptyCount; i++) html += buildStar("empty");

                            container.innerHTML = html;

                            // Accessible label
                            container.setAttribute("aria-label", `Rating ${rating} out of 5`);
                            container.setAttribute("role", "img");
                        }

                        document.querySelectorAll(".product-rating-container").forEach(el => {
                            renderRating(el, el.dataset.rating);
                        });

                    });
                </script>
                <div class="product-details-price-container">
                    <div class="product-discounted-price-container">
                        <p class="quicksand-text sub-sub-title ocean-green-text">${{product.discounted_price}}</p>
                    </div>
                    <div class="product-original-price-container">
                        <p class="lato-text text gray-text">${{product.price}}</p>
                    </div>
                </div>
                <div class="product-details-short-description-container">
                    <p class="lato-text text gray-text">{{ product.description }}</p>
                </div>
                <div class="product-details-stock-container">
                    <p class="lato-text text gray-text">{{ product.stock_qty }} in stock</p>
                </div>
                <div class="product-details-cart-container">
                    <div class="product-cart-container">
                        {% if current_customer %}
                        {% if product.in_cart %}
                        <a href="#" class="js-cart-toggle" data-product-id="{{ product.product_id }}" data-in-cart="1">
                            <img src="https://ik.imagekit.io/intmarket/icons8-tick-100.png" alt="">
                            <p class="text quicksand-text" style="color: #4aba81;">Added</p>
                        </a>
                        {% else %}
                        <a href="#" class="js-cart-toggle" data-product-id="{{ product.product_id }}" data-in-cart="0">
                            <img src="https://ik.imagekit.io/intmarket/icons8-cart-100%20(1).png" alt="">
                            <p class="text quicksand-text" style="color: #4aba81;">Add</p>
                        </a>
                        {% endif %}
                        {% else %}
                        <a href="/login">
                            <img src="https://ik.imagekit.io/intmarket/icons8-cart-100%20(1).png" alt="">
                            <p class="text quicksand-text" style="color: #4aba81;">Add</p>
                        </a>
                        {% endif %}
                    </div>
                </div>
                <script>
                    document.addEventListener("DOMContentLoaded", () => {

                        const ADD_ICON = "https://ik.imagekit.io/intmarket/icons8-cart-100%20(1).png";
                        const ADDED_ICON = "https://ik.imagekit.io/intmarket/icons8-tick-100.png";

                        function setHeaderCartQty(qty) {
                            const pc = document.getElementById("cart-qty-pc");
                            const mobile = document.getElementById("cart-qty-mobile");
                            if (pc) pc.textContent = qty;
                            if (mobile) mobile.textContent = qty;
                        }

                        function setButtonState(aTag, inCart) {
                            aTag.dataset.inCart = inCart ? "1" : "0";

                            const img = aTag.querySelector("img");
                            const txt = aTag.querySelector("p");

                            if (!img || !txt) return;

                            if (inCart) {
                                img.src = ADDED_ICON;
                                txt.textContent = "Added";
                            } else {
                                img.src = ADD_ICON;
                                txt.textContent = "Add";
                            }
                        }

                        async function postJSON(url, data) {
                            const res = await fetch(url, {
                                method: "POST",
                                headers: { "Content-Type": "application/json" },
                                body: JSON.stringify(data)
                            });
                            const json = await res.json().catch(() => ({}));
                            return { res, json };
                        }

                        document.addEventListener("click", async (e) => {
                            const btn = e.target.closest(".js-cart-toggle");
                            if (!btn) return;

                            e.preventDefault();

                            const productId = parseInt(btn.dataset.productId, 10);
                            if (!productId) return;

                            const currentlyInCart = btn.dataset.inCart === "1";
                            const url = currentlyInCart ? "/api/cart/remove" : "/api/cart/add";

                            // prevent double clicks
                            if (btn.dataset.loading === "1") return;
                            btn.dataset.loading = "1";
                            btn.style.opacity = "0.7";
                            btn.style.pointerEvents = "none";

                            try {
                                const { res, json } = await postJSON(url, { product_id: productId });

                                if (res.status === 401 && json && json.redirect) {
                                    window.location.href = json.redirect;
                                    return;
                                }

                                if (!json || !json.ok) return;

                                // Update UI + header
                                setButtonState(btn, json.in_cart);
                                setHeaderCartQty(json.cart_qty);

                            } catch (err) {
                                console.error(err);
                            } finally {
                                btn.dataset.loading = "0";
                                btn.style.opacity = "";
                                btn.style.pointerEvents = "";
                            }
                        });

                    });
                </script>
                <div class="product-details-wishlist-container">
                    {% if current_customer %}
                    {% if product.in_wishlist %}
                    <a href="#" class="js-wishlist-toggle pd-wishlist-btn" data-product-id="{{ product.product_id }}"
                        data-in-wishlist="1">
                        <p class="text quicksand-text ocean-green-text">
                            Added to wishlist
                        </p>
                    </a>
                    {% else %}
                    <a href="#" class="js-wishlist-toggle pd-wishlist-btn" data-product-id="{{ product.product_id }}"
                        data-in-wishlist="0">
                        <p class="text quicksand-text ocean-green-text">
                            Add to wishlist
                        </p>
                    </a>
                    {% endif %}
                    {% else %}
                    <a href="/login" class="pd-wishlist-btn">
                        <p class="text quicksand-text ocean-green-text">
                            Add to wishlist
                        </p>
                    </a>
                    {% endif %}
                </div>
                <script>
                    document.addEventListener("DOMContentLoaded", () => {

                        function setHeaderWishlistQty(qty) {
                            const pc = document.getElementById("wishlist-qty-pc");
                            const mobile = document.getElementById("wishlist-qty-mobile");
                            if (pc) pc.textContent = qty;
                            if (mobile) mobile.textContent = qty;
                        }

                        async function postJSON(url, data) {
                            const res = await fetch(url, {
                                method: "POST",
                                headers: { "Content-Type": "application/json" },
                                body: JSON.stringify(data)
                            });
                            const json = await res.json().catch(() => ({}));
                            return { res, json };
                        }

                        document.addEventListener("click", async (e) => {
                            const btn = e.target.closest(".js-wishlist-toggle");
                            if (!btn) return;

                            // If no product id (logged-out link), allow navigation
                            if (!btn.dataset.productId) return;

                            e.preventDefault();

                            const productId = parseInt(btn.dataset.productId, 10);
                            if (!productId) return;

                            const currentlyInWishlist = btn.dataset.inWishlist === "1";
                            const url = currentlyInWishlist ? "/api/wishlist/remove" : "/api/wishlist/add";

                            if (btn.dataset.loading === "1") return;
                            btn.dataset.loading = "1";
                            btn.style.opacity = "0.7";
                            btn.style.pointerEvents = "none";

                            try {
                                const { res, json } = await postJSON(url, { product_id: productId });

                                if (res.status === 401 && json && json.redirect) {
                                    window.location.href = json.redirect;
                                    return;
                                }

                                if (!json || !json.ok) return;

                                // Update state
                                btn.dataset.inWishlist = json.in_wishlist ? "1" : "0";

                                const p = btn.querySelector("p");
                                if (p) {
                                    p.textContent = json.in_wishlist
                                        ? "Added to wishlist"
                                        : "Add to wishlist";
                                }

                                setHeaderWishlistQty(json.wishlist_qty);

                            } catch (err) {
                                console.error(err);
                            } finally {
                                btn.dataset.loading = "0";
                                btn.style.opacity = "";
                                btn.style.pointerEvents = "";
                            }
                        });

                    });
                </script>
                <div class="product-details-size-container">
                    <p class="lato-text text gray-text">Size: <span class="ocean-green-text">{{product.size}}
                            {{product.unit}}</span></p>
                </div>
                <div class="product-details-brand-container">
                    <p class="lato-text text gray-text">Brands: <span class="ocean-green-text">{{product.brand}}</span>
                    </p>
                </div>
            </div>
        </div>
        <div class="product-details-long-description-container">
            <h1 class="quicksand-text ocean-green-text sub-title" style="margin-bottom: 10px;">Description</h1>
            <p class="lato-text text gray-text">{{ product.long_description }}</p>
        </div>
        <div class="product-details-review-container">
            <h1 class="quicksand-text ocean-green-text sub-title" style="margin-bottom: 10px;">Add a Rating</h1>

            <div class="pd-review-form">
                <p class="lato-text text gray-text" style="margin: 0;">
                    Your email address will not be published. Required fields are marked *
                </p>

                <!-- Rating -->
                <div class="pd-field">
                    <label class="lato-text text gray-text">Your rating *</label>

                    <div class="pd-stars" id="pdStars" data-selected="0" aria-label="Select rating">
                        <!-- 5 stars -->
                        {% for i in range(1, 6) %}
                        <button type="button" class="pd-star" data-value="{{ i }}" aria-label="{{ i }} star">
                            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                                <path
                                    d="M12 2.3l2.85 6.56 7.15.62-5.42 4.7 1.62 7.02L12 17.9 5.8 21.2l1.62-7.02L2 9.48l7.15-.62L12 2.3z">
                                </path>
                            </svg>
                        </button>
                        {% endfor %}
                    </div>

                    <input type="hidden" id="pdRatingValue" value="0">
                </div>

                <!-- Review -->
                <div class="pd-field">
                    <label class="lato-text text gray-text">Your review *</label>
                    <textarea id="pdReviewText" class="pd-textarea lato-text text gray-text" rows="7"
                        placeholder=""></textarea>
                </div>

                <!-- Name -->
                <div class="pd-field">
                    <label class="lato-text text gray-text">Name *</label>
                    <input id="pdReviewName" class="pd-input lato-text text gray-text" type="text" value="">
                </div>

                <!-- Email -->
                <div class="pd-field">
                    <label class="lato-text text gray-text">Email *</label>
                    <input id="pdReviewEmail" class="pd-input lato-text text gray-text" type="email" value="">
                </div>

                <button type="button" id="pdReviewSubmit" class="pd-submit-btn quicksand-text">
                    Submit
                </button>

                <p id="pdReviewMsg" class="lato-text text" style="display:none; margin:0;"></p>
            </div>
        </div>
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const starsWrap = document.getElementById("pdStars");
                const stars = starsWrap ? Array.from(starsWrap.querySelectorAll(".pd-star")) : [];
                const ratingInput = document.getElementById("pdRatingValue");

                const reviewEl = document.getElementById("pdReviewText");
                const nameEl = document.getElementById("pdReviewName");
                const emailEl = document.getElementById("pdReviewEmail");
                const btn = document.getElementById("pdReviewSubmit");
                const msg = document.getElementById("pdReviewMsg");

                let selected = 0;
                let hover = 0;

                function renderStars() {
                    stars.forEach((s) => {
                        const v = parseInt(s.dataset.value, 10);

                        s.classList.remove("is-green", "is-red-outline", "is-red-fill");

                        // Case A: hovering on something
                        if (hover > 0) {
                            // hover > selected => selected stays green, extra hover range becomes red outline
                            if (hover > selected) {
                                if (v <= selected) s.classList.add("is-green");
                                else if (v <= hover) s.classList.add("is-red-outline");
                            }
                            // hover <= selected => hover range becomes red fill, rest of selected stays green
                            else {
                                if (v <= hover) s.classList.add("is-red-fill");
                                else if (v <= selected) s.classList.add("is-green");
                            }
                            return;
                        }

                        // Case B: no hover => show selected green
                        if (v <= selected) s.classList.add("is-green");
                    });
                }

                function setSelected(val) {
                    selected = val;
                    if (ratingInput) ratingInput.value = String(val);
                    renderStars();
                }

                // star events
                stars.forEach((s) => {
                    const v = parseInt(s.dataset.value, 10);

                    s.addEventListener("mouseenter", () => {
                        hover = v;
                        renderStars();
                    });

                    s.addEventListener("click", () => {
                        setSelected(v);
                    });
                });

                if (starsWrap) {
                    starsWrap.addEventListener("mouseleave", () => {
                        hover = 0;
                        renderStars();
                    });
                }

                // init
                renderStars();

                function showMsg(text, ok = true) {
                    if (!msg) return;
                    msg.style.display = "block";
                    msg.textContent = text;
                    msg.style.color = ok ? "#2fb36d" : "#ff3b3b";
                }

                async function postJSON(url, data) {
                    const res = await fetch(url, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(data),
                    });
                    const json = await res.json().catch(() => ({}));
                    return { res, json };
                }

                // submit
                if (btn) {
                    btn.addEventListener("click", async () => {
                        const rating = parseInt(ratingInput?.value || "0", 10);
                        const review = (reviewEl?.value || "").trim();
                        const name = (nameEl?.value || "").trim();
                        const email = (emailEl?.value || "").trim();

                        if (!rating || rating < 1 || rating > 5) {
                            showMsg("Please select a rating (1–5).", false);
                            return;
                        }
                        if (!review) {
                            showMsg("Please write a review.", false);
                            return;
                        }
                        if (!name) {
                            showMsg("Please enter your name.", false);
                            return;
                        }
                        if (!email) {
                            showMsg("Please enter your email.", false);
                            return;
                        }

                        btn.disabled = true;

                        try {
                            const { res, json } = await postJSON("/api/ratings/add", {
                                product_id: {{ product.product_id }},
                        rating: rating,
                            review: review,
                                name: name,
                                    email: email
                    });

                    if (res.status === 401 && json && json.redirect) {
                        window.location.href = json.redirect;
                        return;
                    }

                    if (!json || !json.ok) {
                        showMsg(json && json.error ? json.error : "Something went wrong.", false);
                        return;
                    }

                    // ✅ clear fields after success
                    if (reviewEl) reviewEl.value = "";
                    if (nameEl) nameEl.value = "";
                    if (emailEl) emailEl.value = "";
                    setSelected(0);
                    hover = 0;

                    showMsg("Review submitted successfully!", true);

                } catch (e) {
                    console.error(e);
                    showMsg("Network error. Please try again.", false);
                } finally {
                    btn.disabled = false;
                }
            });
    }
});
        </script>
        {% if product.ratings_list and product.ratings_list|length > 0 %}
        <div class="product-details-ratings-container">
            <div class="pd-reviews-list">
                {% for r in product.ratings_list %}
                <div class="pd-review-card">
                    <div class="pd-review-top">
                        <p class="quicksand-text sub-sub-title rhino-text pd-review-name">
                            {{ r.name }}
                            <span class="lato-text text gray-text pd-review-date">
                                - {{ r.created_at_formatted }}
                            </span>
                        </p>

                        <div class="product-rating-container pd-review-stars" data-rating="{{ r.rating }}"
                            aria-label="Rating {{ r.rating }} out of 5">
                        </div>
                    </div>

                    <p class="lato-text text gray-text pd-review-text">
                        {{ r.review }}
                    </p>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        <script>
            document.addEventListener("DOMContentLoaded", () => {

                const STAR_SVG = `
<svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
  <path d="M12 2.3l2.85 6.56 7.15.62-5.42 4.7 1.62 7.02L12 17.9 5.8 21.2l1.62-7.02L2 9.48l7.15-.62L12 2.3z"></path>
</svg>
`;

                function clamp(num, min, max) {
                    return Math.min(max, Math.max(min, num));
                }

                function buildStar(type) {
                    if (type === "full") return `<span class="star full">${STAR_SVG}</span>`;
                    if (type === "empty") return `<span class="star empty">${STAR_SVG}</span>`;
                    return `
<span class="star half">
  <span class="base">${STAR_SVG}</span>
  <span class="fill">${STAR_SVG}</span>
</span>`;
                }

                function renderRating(container, ratingRaw) {
                    let rating = parseFloat(ratingRaw);
                    if (Number.isNaN(rating)) rating = 0;

                    rating = clamp(rating, 0, 5);

                    // round to nearest 0.5 (safe even though review ratings are integers)
                    rating = Math.round(rating * 2) / 2;

                    const fullCount = Math.floor(rating);
                    const hasHalf = (rating - fullCount) === 0.5;
                    const emptyCount = 5 - fullCount - (hasHalf ? 1 : 0);

                    let html = "";
                    for (let i = 0; i < fullCount; i++) html += buildStar("full");
                    if (hasHalf) html += buildStar("half");
                    for (let i = 0; i < emptyCount; i++) html += buildStar("empty");

                    container.innerHTML = html;
                    container.setAttribute("aria-label", `Rating ${rating} out of 5`);
                    container.setAttribute("role", "img");
                }

                document.querySelectorAll(".product-rating-container").forEach(el => {
                    renderRating(el, el.dataset.rating);
                });

            });
        </script>
    </section>
    <footer class="footer-section">
        <div class="footer-newsletter-section">
            <div class="newsletter-subscribe-container">
                <div class="newsletter-subscribe-content-container">
                    <h1 class="quicksand-text rhino-text page-title">Join our list & never miss exclusive grocery deals
                        again
                    </h1>
                    <p class="lato-text text gray-text">Sign up today and receive updates, discounts, and weekly offers
                    </p>
                    <div class="newsletter-subscribe-input-container">
                        <input id="newsletterEmail" class="gray-text text lato-text" type="text"
                            placeholder="Your email address">
                        <a id="newsletterSubscribeBtn" href="#" class="gray-text text lato-text">Subscribe</a>
                    </div>
                    <script>
                        document.addEventListener("DOMContentLoaded", () => {
                            const input = document.getElementById("newsletterEmail");
                            const btn = document.getElementById("newsletterSubscribeBtn");

                            if (!input || !btn) return;

                            btn.addEventListener("click", async (e) => {
                                e.preventDefault();

                                const email = (input.value || "").trim();
                                if (!email) return;

                                try {
                                    const res = await fetch("/api/newsletter/subscribe", {
                                        method: "POST",
                                        headers: { "Content-Type": "application/json" },
                                        body: JSON.stringify({ email })
                                    });

                                    const data = await res.json();

                                    if (data.ok) {
                                        input.value = ""; // ✅ clear input
                                        // optional: show success message
                                        // alert(data.message);
                                    } else {
                                        // optional: show error message
                                        // alert(data.message || "Failed");
                                    }
                                } catch (err) {
                                    // optional: alert("Network error");
                                    console.error(err);
                                }
                            });
                        });
                    </script>
                </div>
                <div class="newsletter-subscribe-image-container">
                    <img src="https://themepanthers.com/wp/nest/d1/wp-content/uploads/2022/02/banner-9-min.png" alt="">
                </div>
            </div>
        </div>
        <div class="footer-features-section">
            <div class="footer-feature-container">
                <div class="footer-feature-image-container">
                    <img src="https://ik.imagekit.io/intmarket/icon-1.png" alt="">
                </div>
                <div class="footer-feature-content-container">
                    <h1 class="sub-sub-title quicksand-text rhino-text">Best prices & offers</h1>
                    <p class="text lato-text gray-text">Fresh savings on daily essentials</p>
                </div>
            </div>
            <div class="footer-feature-container">
                <div class="footer-feature-image-container">
                    <img src="https://ik.imagekit.io/intmarket/icon-2.png" alt="">
                </div>
                <div class="footer-feature-content-container">
                    <h1 class="sub-sub-title quicksand-text rhino-text">Freshness Guaranteed</h1>
                    <p class="text lato-text gray-text">Quality checked before delivery</p>
                </div>
            </div>
            <div class="footer-feature-container">
                <div class="footer-feature-image-container">
                    <img src="https://ik.imagekit.io/intmarket/icon-3.png" alt="">
                </div>
                <div class="footer-feature-content-container">
                    <h1 class="sub-sub-title quicksand-text rhino-text">Great daily deal</h1>
                    <p class="text lato-text gray-text">Exclusive offers when you sign up</p>
                </div>
            </div>
            <div class="footer-feature-container">
                <div class="footer-feature-image-container">
                    <img src="https://ik.imagekit.io/intmarket/icon-4.png" alt="">
                </div>
                <div class="footer-feature-content-container">
                    <h1 class="sub-sub-title quicksand-text rhino-text">Wide assortment</h1>
                    <p class="text lato-text gray-text">Everything you need in one place</p>
                </div>
            </div>
            <div class="footer-feature-container">
                <div class="footer-feature-image-container">
                    <img src="https://ik.imagekit.io/intmarket/icon-5.png" alt="">
                </div>
                <div class="footer-feature-content-container">
                    <h1 class="sub-sub-title quicksand-text rhino-text">Customer Support</h1>
                    <p class="text lato-text gray-text">Fast help whenever you need it</p>
                </div>
            </div>
        </div>
        <div class="footer-menu-section">
            <div class="footer-menu-main-content-container">
                <div class="footer-logo-container">
                    <img src="https://ik.imagekit.io/intmarket/logo.png?updatedAt=1763862184023" alt="">
                </div>
                <div class="footer-description-container">
                    <p class="lato-text text rhino-text">Fresh, high-quality groceries delivered with care—bringing
                        everyday essentials, great value, and trusted service straight to your neighborhood, every
                        single day.</p>
                </div>
                <div class="footer-info-container">
                    <div class="footer-info-item-container">
                        <div class="footer-info-item-image-container">
                            <img src="https://ik.imagekit.io/intmarket/icons8-location-100%20(3).png" alt="">
                        </div>
                        <div class="footer-info-item-content-container">
                            <p class="lato-text text rhino-text">{{app_settings.address}}</p>
                        </div>
                    </div>
                    <div class="footer-info-item-container">
                        <div class="footer-info-item-image-container">
                            <img src="https://ik.imagekit.io/intmarket/icons8-headphones-100%20(1).png" alt="">
                        </div>
                        <div class="footer-info-item-content-container">
                            <p class="rhino-text text lato-text">
                                Need help? Call Us:
                                <a href="tel:{{app_settings.number_to_give}}"
                                    class="ocean-green-text">{{app_settings.number_to_show}}</a>
                            </p>
                        </div>
                    </div>
                    <div class="footer-info-item-container">
                        <div class="footer-info-item-image-container">
                            <img src="https://ik.imagekit.io/intmarket/icons8-email-100.png?updatedAt=1766535705131"
                                alt="">
                        </div>
                        <div class="footer-info-item-content-container">
                            <p class="lato-text text rhino-text">{{app_settings.email}}</p>
                        </div>
                    </div>
                    <div class="footer-info-item-container">
                        <div class="footer-info-item-image-container">
                            <img src="https://ik.imagekit.io/intmarket/icons8-delivery-time-100.png?updatedAt=1766535705033"
                                alt="">
                        </div>
                        <div class="footer-info-item-content-container">
                            <p class="lato-text text rhino-text">{{app_settings.hours}}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer-menu-items-container">
                <div class="footer-menu-category-container">
                    <h1 class="sub-title quicksand-text rhino-text">Account</h1>
                    <div class="footer-menu-items-content-container">
                        <a href="{{ '/my-account/' if current_customer else '/login' }}"
                            class="pc-third-ribbon-menu-link rhino-text text lato-text">My Account</a>
                        <a href="{{ '/cart/' if current_customer else '/login' }}"
                            class="pc-third-ribbon-menu-link rhino-text text lato-text">View Cart</a>
                        <a href="{{ '/wishlist/' if current_customer else '/login' }}"
                            class="pc-third-ribbon-menu-link rhino-text text lato-text">My Wishlist</a>
                        <a href="/#popular-products" class="pc-third-ribbon-menu-link rhino-text text lato-text">Popular
                            Products</a>
                        <a href="/cart#recently-viewed"
                            class="pc-third-ribbon-menu-link rhino-text text lato-text">Recently Viewed</a>
                        <a href="/#hot-deals" class="pc-third-ribbon-menu-link rhino-text text lato-text">Deals</a>
                        <a href="/#hot-deals" class="pc-third-ribbon-menu-link rhino-text text lato-text">Hot deals</a>
                    </div>
                </div>
                <div class="footer-menu-category-container">
                    <h1 class="sub-title quicksand-text rhino-text">Company</h1>
                    <div class="footer-menu-items-content-container">
                        <a href="/about-us/" class="pc-third-ribbon-menu-link rhino-text text lato-text">About Us</a>
                        <a href="/refund-and-return-policy/"
                            class="pc-third-ribbon-menu-link rhino-text text lato-text">Refund and Return Policy</a>
                        <a href="/privacy-policy/" class="pc-third-ribbon-menu-link rhino-text text lato-text">Privacy
                            Policy</a>
                        <a href="/terms-and-conditions/"
                            class="pc-third-ribbon-menu-link rhino-text text lato-text">Terms and Conditions</a>
                        <a href="/contact-us/" class="pc-third-ribbon-menu-link rhino-text text lato-text">Contact
                            Us</a>
                        <a href="/suggest-product/" class="pc-third-ribbon-menu-link rhino-text text lato-text">Suggest
                            a Product</a>
                        <a href="/help-center/" class="pc-third-ribbon-menu-link rhino-text text lato-text">Help
                            center</a>
                    </div>
                </div>
                <div class="footer-menu-category-container">
                    <h1 class="sub-title quicksand-text rhino-text">Shop by Categories</h1>
                    <div class="footer-menu-items-content-container">
                        {% for cat in mega_parent_categories %}
                        <a href="/subcategories/?category_name={{ cat.slug }}"
                            class="pc-third-ribbon-menu-link rhino-text lato-text text">
                            {{ cat.name }}
                        </a>
                        {% endfor %}
                    </div>
                </div>
                <div class="footer-menu-category-container">
                    <h1 class="sub-title quicksand-text rhino-text">Featured Categories</h1>
                    <div class="footer-menu-items-content-container">
                        {% for sub in mega_featured_subcategories %}
                        <a href="/search-results/?category_name={{ sub.slug }}"
                            class="pc-third-ribbon-menu-link rhino-text lato-text text">
                            {{ sub.name }}
                        </a>
                        {% endfor %}

                        <a href="/#featured-categories" class="pc-third-ribbon-menu-link rhino-text lato-text text">
                            View All Featured Categories
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-ending-section">
            <p class="lato-text text gray-text">&copy; International Market - All Rights Reserved</p>
        </div>
    </footer>
</body>

</html>